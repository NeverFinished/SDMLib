apply plugin: 'java'
apply plugin: 'maven'
apply plugin: 'eclipse'
apply plugin: 'idea'

// apply plugins/external files only on jenkins build
// jenkins needs -Pjenkins switch
if (project.hasProperty('jenkins')) {
    //apply plugin: 'jacoco'
    apply from: 'artifactory.gradle'
    apply from: 'version.gradle'
}

buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath(group: 'org.jfrog.buildinfo', name: 'build-info-extractor-gradle', version: '2.2.4')
    }
}

sourceSets {
    main {
        java {
            srcDirs = ['src', 'replicationsrc']
        }
        resources {
            srcDir 'src/org/sdmlib/doc/JavascriptAdapter'
        }
        //output.resourcesDir = "${buildDir}/org/sdmlib/doc/JavascriptAdapter"
    }
    test {
        java {
            srcDir 'examples'
        }
        resources {
            srcDir 'src/org/sdmlib/doc/JavascriptAdapter'
        }
    }
}

test {
    if (project.hasProperty('maxParallelForks'))
        maxParallelForks = project.maxParallelForks as int
    if (project.hasProperty('forkEvery'))
        forkEvery = project.forkEvery as int
}

task copyResources(type: Copy) {
    println "Running copy task"
    from 'src/org/sdmlib/doc/JavascriptAdapter'
    println "Copying from src/org/sdmlib/doc/JavascriptAdapter "
    println "To: ${buildDir}/org/sdmlib/doc/JavascriptAdapter would be better?"
    into "${buildDir}/org/sdmlib/doc/JavascriptAdapter"
}

jar.dependsOn()

repositories {
    jcenter()
    mavenLocal()
    mavenCentral()

    // NetworkParser
    maven { url "https://se.cs.uni-kassel.de/artifactory/libs-snapshot-local" }
}

dependencies {
    compile group: "junit", name: "junit", version: "4.+"
    compile 'de.uniks:Networkparser:4.2+'
}

test {
    testLogging {
        showStandardStreams = true
        showStackTraces = true
        exceptionFormat = "full"
    }
}

// Java Compiler Args
tasks.withType(JavaCompile) {
    //Suppress underscore warnings
    options.compilerArgs << '-Xlint:none'
}

