<html>
<head><meta http-equiv="X-UA-Compatible" content="IE=9">
<meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="style.css">
<link href="includes/diagramstyle.css" rel="stylesheet" type="text/css">

<script src="includes/dagre.js"></script>
<script src="includes/graph.js"></script>
<script src="includes/layout_dagre.js"></script>
<script src="includes/lines.js"></script>
</head><body onload="init();">
<p>Storyboard <a href='../examples/org/sdmlib/examples/helloworld/HelloWorldTTC2011.java' type='text/x-java'>TTC2011HelloWorldCountNumberOfNodes</a></p>
<p>TTC2011HelloWorldCountNumberOfNodes</p>
<hr/><p>Simple Graph application classes: </p>
<embed type="image/svg+xml" src='TTC2011HelloWorldSimpleGraphClassDiag.svg'><hr/><p>create example graph: </p>
<embed type="image/svg+xml" src='TTC2011HelloWorldCountNumberOfNodes7.svg'>
<hr/><h2>Count nodes in graph direct: </h2><pre>   public void countNodesInJava(Graph graph)
   {
      int noOfNodes = graph.getNodes().size();
      
      systemout = &quot;Number of nodes: &quot; + noOfNodes;
   }</pre><p>systemout: Number of nodes: 8</p>
<p>Count nodes in graph per pattern: </p>
<pre>   public void countNodesPerPattern(Graph graph)
   {
      ModelPattern p = new ModelPattern();
      
      GraphPO graphPO = p.hasElementGraphPO(graph);
      
      NodePO nodePO = graphPO.hasNodes();
      
      int noOfNodes = p.allMatches();
      
      systemout = &quot;Number of nodes: &quot; + noOfNodes;
   }</pre><embed type="image/svg+xml"src='countNodesPerPatternRule.svg'>
<embed type="image/svg+xml"src='countNodesPerPatternRuleWithMatch.svg'>
<p>systemout: Number of nodes: 8</p>
<p>Retrieve set of matching nodes per pattern and count its elements: </p>
<pre>   public void countNodesPerNodeSet(Graph graph)
   {
      NodeSet allMatches = new ModelPattern()
      .hasElementGraphPO(graph)
      .hasNodes()
      .allMatches();
      
      systemout = &quot;Nodes: &quot; + allMatches.getName().concat(&quot;, &quot;) + &quot; Number of nodes: &quot; + allMatches.size();      
   }</pre><embed type="image/svg+xml"src='countNodesPerNodeSet.svg'>
<embed type="image/svg+xml"src='countNodesPerNodeSetWithMatch.svg'>
<p>systemout: Nodes: n1, n2, n3, n4, n5, n6, n7, n8 Number of nodes: 8</p>
<hr/><h2>Retrieve set of looping edges per pattern and count its elements: </h2><pre>   public void countLoopingEdgesPerPattern(Graph graph)
   {
      EdgePO edgesPO = new ModelPattern()
      .hasElementGraphPO(graph)
      .hasEdges();
      
      NodePO srcPO = edgesPO.hasSrc();
      
      edgesPO.hasTgt(srcPO);
      
      EdgeSet loopingEdges = edgesPO.allMatches();
      
      systemout = &quot;Looping Edges: &quot; + loopingEdges.getName().concat(&quot;, &quot;) + &quot; Number of looping edges: &quot; + loopingEdges.size();
   }</pre><embed type="image/svg+xml"src='countLoopingEdgesPerPattern.svg'>
<embed type="image/svg+xml"src='countLoopingEdgesPerPatternWithMatch.svg'>
<p>systemout: Looping Edges: e16, e17 Number of looping edges: 2</p>
<p>For comparison a Java solution: </p>
<pre>   public void countLoopingEdgesInJava(Graph graph)
   {
      String sysout = &quot;Looping Edges: &quot;;
      
      int noOfLoopingEdges = 0;
      
      for (Edge edge : graph.getEdges())
      {
         if (edge.getSrc() != null &amp;&amp; edge.getSrc() == edge.getTgt())
         {
            noOfLoopingEdges++;
            
            sysout += edge.getName() + &quot;, &quot;;
         }
      }
      
      systemout = sysout.substring(0, sysout.length() - 2) + &quot; Number of looping edges: &quot; + noOfLoopingEdges;
   }</pre><p>systemout: Looping Edges: e16, e17 Number of looping edges: 2</p>
<hr/><h2>Retrieve isolated nodes and count them: </h2><pre>   public ModelPattern countIsolatedNodesPerPattern(Graph graph)
   {
      ModelPattern p = new ModelPattern();
      
      GraphPO graphPO = p.hasElementGraphPO(graph);
      
      NodePO nodePO = graphPO.hasNodes();
      
      nodePO.startNAC().hasOutEdges().endNAC();
      
      nodePO.startNAC().hasInEdges().endNAC();

      NodeSet isolatedNodes = nodePO.allMatches();
      
      systemout = &quot;Isolated nodes: &quot; + isolatedNodes.getName().concat(&quot;, &quot;) + &quot; Number of isolated nodes: &quot; + isolatedNodes.size();
      
      return p;
   }</pre><embed type="image/svg+xml"src='countIsolatedNodesPerPattern.svg'>
<embed type="image/svg+xml"src='countIsolatedNodesPerPatternWithMatch.svg'>
<p>systemout: Isolated nodes: n6, n7 Number of isolated nodes: 2</p>
<p>For comparison a Java solution: </p>
<pre>   public void countIsolatedNodesInJava(Graph graph)
   {
      systemout = &quot;Isolated nodes: &quot;;
      
      int noOfIsolatedNodes = 0;
      
      for (Node isoNode : graph.getNodes())
      {
         if (isoNode.getOutEdges().size() == 0 
               &amp;&amp; isoNode.getInEdges().size() == 0)
         {
            noOfIsolatedNodes++;
            
            systemout += isoNode.getName() + &quot;, &quot;;
         }
      }
      
      systemout = systemout.substring(0, systemout.length() - 2) + &quot; Number of isolated nodes: &quot; + noOfIsolatedNodes;
   }</pre><p>systemout: Isolated nodes: n6, n7 Number of isolated nodes: 2</p>
<hr/><h2>Count circles of three nodes: </h2><pre>   public ModelPattern countCirclesOfThreeNodesPerPattern(Graph graph)
   {
      ModelPattern p = new ModelPattern();
      
      GraphPO graphPO = p.hasElementGraphPO(graph);
      
      NodePO firstCircleNodePO = graphPO.hasNodes();
      
      NodePO secondCircleNodePO = firstCircleNodePO.hasOutEdges().hasTgt();
      
      NodePO thirdCircleNodePO = secondCircleNodePO.hasOutEdges().hasTgt();
      
      thirdCircleNodePO.hasOutEdges().hasTgt(firstCircleNodePO);
      
      p.matchIsomorphic();
      
      int noOfCircles = p.allMatches();
      
      systemout = &quot;Circles found: &quot; + noOfCircles;
      
      return p;
   }</pre><embed type="image/svg+xml"src='countCirclesOfThreeNodesPerPattern.svg'>
<embed type="image/svg+xml"src='countCirclesOfThreeNodesPerPatternWithMatch.svg'>
<p>systemout: Circles found: 6</p>
<p>If you want to print the matched nodes for each circle, you need to iterate through the matches: </p>
<pre>   public ModelPattern countCirclesOfThreeNodesPerPatternReportMatches(Graph graph)
   {
      ModelPattern p = new ModelPattern();
      
      GraphPO graphPO = p.hasElementGraphPO(graph);
      
      NodePO firstCircleNodePO = graphPO.hasNodes();
      
      NodePO secondCircleNodePO = firstCircleNodePO.hasOutEdges().hasTgt();
      
      NodePO thirdCircleNodePO = secondCircleNodePO.hasOutEdges().hasTgt();
      
      thirdCircleNodePO.hasOutEdges().hasTgt(firstCircleNodePO);
      
      p.matchIsomorphic();
      
      systemout = &quot;Circles found: \n&quot;;
      int noOfCircles = 0;
      
      while (p.getHasMatch())
      {
         systemout += firstCircleNodePO.getName() + &quot; --&gt; &quot;
               + secondCircleNodePO.getName() + &quot; --&gt; &quot; 
               + thirdCircleNodePO.getName() + &quot; --&gt; \n&quot;;
         
         noOfCircles++; 
         
         p.findNextMatch();
      }
      
      systemout += &quot;&quot; + noOfCircles + &quot; circles found&quot;;
      
      return p;
   }</pre><embed type="image/svg+xml"src='countCirclesOfThreeNodesPerPatternReportMatches.svg'>
<embed type="image/svg+xml"src='countCirclesOfThreeNodesPerPatternReportMatchesWithMatch.svg'>
<p>systemout: Circles found: 
n1 --> n2 --> n3 --> 
n2 --> n3 --> n1 --> 
n3 --> n1 --> n2 --> 
n3 --> n4 --> n5 --> 
n4 --> n5 --> n3 --> 
n5 --> n3 --> n4 --> 
6 circles found</p>
<p>Just for comparison, a plain java implementation: </p>
<pre>   public void countCirclesOfThreeNodesInJava(Graph graph)
   {
      int noOfCircles = 0;
      
      systemout = &quot;Circles found: \n&quot;;
      
      for (Node firstNode : graph.getNodes())
      {
         for (Edge firstEdge : firstNode.getOutEdges())
         {
            Node secondNode = firstEdge.getTgt();
            
            if (secondNode != null &amp;&amp; secondNode != firstNode)
            {
               for (Edge secondEdge : secondNode.getOutEdges())
               {
                  Node thirdNode = secondEdge.getTgt();
            
                  if (thirdNode != null &amp;&amp; thirdNode != secondNode &amp;&amp; thirdNode != firstNode)
                  {
                     for (Edge thirdEdge : thirdNode.getOutEdges())
                     {
                        if (thirdEdge.getTgt() == firstNode)
                        {
                           &#x2F;&#x2F; found match
                           systemout += firstNode.getName() + &quot; --&gt; &quot;
                                 + secondNode.getName() + &quot; --&gt; &quot; 
                                 + thirdNode.getName() + &quot; --&gt; \n&quot;;
                           
                           noOfCircles++;
                        }
                     }
                  }
               }
            }
         }
      }
      
      systemout += &quot;&quot; + noOfCircles + &quot; circles found&quot;;
   }</pre><p>systemout: Circles found: 
n1 --> n2 --> n3 --> 
n2 --> n3 --> n1 --> 
n3 --> n1 --> n2 --> 
n3 --> n4 --> n5 --> 
n4 --> n5 --> n3 --> 
n5 --> n3 --> n4 --> 
6 circles found</p>
<hr/><h2>Count dangling edges per pattern: </h2><pre>   public ModelPattern countDanglingEdgesPerPattern(Graph graph)
   {
      ModelPattern p = new ModelPattern();
      
      EdgePO edgePO = p.hasElementGraphPO(graph).hasEdges();
      
      edgePO.startNAC().hasTgt();
      
      edgePO.hasSrc().endNAC();
      
      EdgeSet allMatches = edgePO.allMatches();
      
      systemout = &quot;Dangling edges &quot; + allMatches.getName().concat(&quot;, &quot;) + &quot; number: &quot; + allMatches.size();
      
      return p;
   }</pre><embed type="image/svg+xml"src='countDanglingEdgesPerPattern.svg'>
<embed type="image/svg+xml"src='countDanglingEdgesPerPatternWithMatch.svg'>
<p>systemout: Dangling edges e18, e19 number: 2</p>
<p>Count dangling edges in Java: </p>
<pre>   public void countDanglingEdgesInJava(Graph graph)
   {
      systemout = &quot;Dangling edges &quot;; 
      
      int noOfMatches = 0;
      
      for (Edge edge : graph.getEdges())
      {
         if (edge.getSrc() == null
               || edge.getTgt() == null)
         {
            systemout += edge.getName() + &quot;, &quot;;
            
            noOfMatches++;
         }
      }
      
      systemout = systemout.substring(0, systemout.length() - 2) + &quot; number: &quot; + noOfMatches;
   }</pre><p>systemout: Dangling edges e18, e19 number: 2</p>

</body>
</html>
