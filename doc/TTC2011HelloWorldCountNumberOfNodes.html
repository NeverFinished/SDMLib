<html>
<body>
<p>Scenario <a href='../examples/org/sdmlib/examples/helloworld/HelloWorldTTC2011.java' type='text/x-java'>TTC2011HelloWorldCountNumberOfNodes</a></p>
<hr/><pre>Simple Graph application classes: </pre>
<img src='TTC2011HelloWorldSimpleGraphClassDiag.svg'><hr/><pre>create example graph: </pre>
<img src='TTC2011HelloWorldCountNumberOfNodes7.svg'>
<img src='TTC2011HelloWorldCountNumberOfNodes8.svg'>
<img src='TTC2011HelloWorldCountNumberOfNodes9.svg'>
<img src='TTC2011HelloWorldCountNumberOfNodes10.svg'>
<hr/><h2>Count nodes in graph direct: </h2><pre>      int noOfNodes = graph.getNodes().size();
      
      String systemout = "Number of nodes: " + noOfNodes;
</pre>
<pre>systemout: Number of nodes: 8</pre>
<pre>Count nodes in graph per pattern: </pre>
<pre>      ModelPattern p = new ModelPattern();
      
      GraphPO graphPO = p.hasElementGraphPO(graph);
      
      NodePO nodePO = graphPO.hasNodes();
      
      noOfNodes = p.allMatches();
      
      systemout = "Number of nodes: " + noOfNodes;
</pre>
<pre>systemout: Number of nodes: 8</pre>
<pre>Retrieve set of matching nodes per pattern and count its elements: </pre>
<pre>      p = new ModelPattern();
      
      graphPO = p.hasElementGraphPO(graph);
      
      nodePO = graphPO.hasNodes();
      
      NodeSet allMatches = nodePO.allMatches();
      
      systemout = "Nodes: " + allMatches.getName().concat(", ") + " Number of nodes: " + allMatches.size();
</pre>
<pre>systemout: Nodes: n1, n2, n3, n4, n5, n6, n7, n8 Number of nodes: 8</pre>
<hr/><h2>Retrieve set of looping edges per pattern and count its elements: </h2><pre>      p = new ModelPattern();
      
      graphPO = p.hasElementGraphPO(graph);
      
      EdgePO edgesPO = graphPO.hasEdges();
      
      NodePO srcPO = edgesPO.hasSrc();
      
      edgesPO.hasTgt(srcPO);
      
      EdgeSet loopingEdges = edgesPO.allMatches();
      
      systemout = "Looping Edges: " + loopingEdges.getName().concat(", ") + " Number of looping edges: " + loopingEdges.size();
</pre>
<pre>systemout: Looping Edges: e16, e17 Number of looping edges: 2</pre>
<pre>For comparison a Java solution: </pre>
<pre>      String sysout = "Looping Edges: ";
      
      int noOfLoopingEdges = 0;
      
      for (Edge edge : graph.getEdges())
      {
         if (edge.getSrc() != null && edge.getSrc() == edge.getTgt())
         {
            noOfLoopingEdges++;
            
            sysout += edge.getName() + ", ";
         }
      }
      
      sysout = sysout.substring(0, sysout.length() - 2) + " Number of looping edges: " + noOfLoopingEdges;
</pre>
<pre>sysout: Looping Edges: e16, e17 Number of looping edges: 2</pre>
<hr/><h2>Retrieve isolated nodes and count them: </h2><pre>      p = new ModelPattern();
      
      graphPO = p.hasElementGraphPO(graph);
      
      nodePO = graphPO.hasNodes();
      
      nodePO.startNAC().hasOutEdges().endNAC();
      
      nodePO.startNAC().hasInEdges().endNAC();

      NodeSet isolatedNodes = nodePO.allMatches();
      
      systemout = "Isolated nodes: " + isolatedNodes.getName().concat(", ") + " Number of isolated nodes: " + isolatedNodes.size();
</pre>
<pre>systemout: Isolated nodes: n6, n7 Number of isolated nodes: 2</pre>
<pre>For comparison a Java solution: </pre>
<pre>      sysout = "Isolated nodes: ";
      
      int noOfIsolatedNodes = 0;
      
      for (Node isoNode : graph.getNodes())
      {
         if (isoNode.getOutEdges().size() == 0 
               && isoNode.getInEdges().size() == 0)
         {
            noOfIsolatedNodes++;
            
            sysout += isoNode.getName() + ", ";
         }
      }
      
      sysout = sysout.substring(0, sysout.length() - 2) + " Number of isolated nodes: " + noOfIsolatedNodes;
</pre>
<pre>sysout: Isolated nodes: n6, n7 Number of isolated nodes: 2</pre>
<hr/><h2>Count circles of three nodes: </h2><pre>      p = new ModelPattern();
      
      graphPO = p.hasElementGraphPO(graph);
      
      NodePO firstCircleNodePO = graphPO.hasNodes();
      
      NodePO secondCircleNodePO = firstCircleNodePO.hasOutEdges().hasTgt();
      
      NodePO thirdCircleNodePO = secondCircleNodePO.hasOutEdges().hasTgt();
      
      thirdCircleNodePO.hasOutEdges().hasTgt(firstCircleNodePO);
      
      p.matchIsomorphic();
      
      int noOfCircles = p.allMatches();
      
      systemout = "Circles found: " + noOfCircles;
</pre>
<pre>systemout: Circles found: 6</pre>
<pre>If you want to print the matched nodes for each circle, you need to iterate through the matches: </pre>
<pre>      p = new ModelPattern();
      
      graphPO = p.hasElementGraphPO(graph);
      
      firstCircleNodePO = graphPO.hasNodes();
      
      secondCircleNodePO = firstCircleNodePO.hasOutEdges().hasTgt();
      
      thirdCircleNodePO = secondCircleNodePO.hasOutEdges().hasTgt();
      
      thirdCircleNodePO.hasOutEdges().hasTgt(firstCircleNodePO);
      
      p.matchIsomorphic();
      
      systemout = "Circles found: n";
      noOfCircles = 0;
      
      while (p.getHasMatch())
      {
         systemout += firstCircleNodePO.getName() + " --> "
               + secondCircleNodePO.getName() + " --> " 
               + thirdCircleNodePO.getName() + " --> n";
         
         noOfCircles++; 
         
         p.findNextMatch();
      }
      
      systemout += "" + noOfCircles + " circles found";
</pre>
<pre>systemout: Circles found: 
n1 --> n2 --> n3 --> 
n2 --> n3 --> n1 --> 
n3 --> n1 --> n2 --> 
n3 --> n4 --> n5 --> 
n4 --> n5 --> n3 --> 
n5 --> n3 --> n4 --> 
6 circles found</pre>
<pre>Just for comparison, a plain java implementation: </pre>
<pre>      noOfCircles = 0;
      
      sysout = "Circles found: n";
      
      for (Node firstNode : graph.getNodes())
      {
         for (Edge firstEdge : firstNode.getOutEdges())
         {
            Node secondNode = firstEdge.getTgt();
            
            if (secondNode != null && secondNode != firstNode)
            {
               for (Edge secondEdge : secondNode.getOutEdges())
               {
                  Node thirdNode = secondEdge.getTgt();
            
                  if (thirdNode != null && thirdNode != secondNode && thirdNode != firstNode)
                  {
                     for (Edge thirdEdge : thirdNode.getOutEdges())
                     {
                        if (thirdEdge.getTgt() == firstNode)
                        {
                           // found match
                           sysout += firstNode.getName() + " --> "
                                 + secondNode.getName() + " --> " 
                                 + thirdNode.getName() + " --> n";
                           
                           noOfCircles++;
                        }
                     }
                  }
               }
            }
         }
      }
      
      sysout += "" + noOfCircles + " circles found";
</pre>
<pre>sysout: Circles found: 
n1 --> n2 --> n3 --> 
n2 --> n3 --> n1 --> 
n3 --> n1 --> n2 --> 
n3 --> n4 --> n5 --> 
n4 --> n5 --> n3 --> 
n5 --> n3 --> n4 --> 
6 circles found</pre>

</body>
</html>
