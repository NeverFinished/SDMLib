<html>
<head><meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="style.css">
<link href="includes/diagramstyle.css" rel="stylesheet" type="text/css">

<script src="includes/dagre.js"></script>
<script src="includes/drawer.js"></script>
<script src="includes/graph.js"></script>
</head><body onload="init();">
<p>Storyboard <a href='../examples/org/sdmlib/examples/helloworld/HelloWorldTTC2011.java' type='text/x-java'>TTC2011SimpleMigration</a></p>
<p>TTC2011SimpleMigration</p>
<hr/><p>Source model:</p>
<embed type="image/svg+xml" src='TTC2011SimpleMigrationClassDiagram3.svg'><hr/><p>Target model:</p>
<embed type="image/svg+xml" src='TTC2011SimpleMigrationClassDiagram6.svg'><hr/><p>Migration extension:</p>
<embed type="image/svg+xml" src='TTC2011SimpleMigrationClassDiagram9.svg'><hr/><p>Create example source graph: </p>
<embed type="image/svg+xml" src='TTC2011SimpleMigration13.svg'>
<hr/><h2>Migrate per pattern: </h2><pre>   private Graph simpleMigrationPerPattern(Graph graph, Storyboard storyboard)
   {
      &#x2F;&#x2F;==========================================================================
      &#x2F;&#x2F; create target graph
      srcGraphPO = new GraphPO(graph);
      
      GraphPO tgtGraphPO = (GraphPO) new GraphPO().withPattern(srcGraphPO.getPattern()).withModifier(Pattern.CREATE);
      tgtGraphPO.findNextMatch();
      
      Graph result = tgtGraphPO.getCurrentMatch();
      
      storyboard.addPattern(srcGraphPO, false);
      
      &#x2F;&#x2F;==========================================================================
      &#x2F;&#x2F; copy nodes
      int noOfMatches = 0;
      
      srcGraphPO = new GraphPO(graph);
      
      NodePO srcNodePO = srcGraphPO.hasNodes();
      
      tgtGraphPO = (GraphPO) new GraphPO(tgtGraphPO.getCurrentMatch())
      .withPattern(srcGraphPO.getPattern());

      srcGraphPO.startCreate();
      
      NodePO tgtNodePO = tgtGraphPO.hasGcsNode();
      
      tgtNodePO.hasOrig(srcNodePO);
      
      while (srcGraphPO.getPattern().getHasMatch())
      {
         tgtNodePO.withText(srcNodePO.getName());
         
         noOfMatches++;
         
         srcGraphPO.getPattern().findNextMatch();
      }
      
      systemout = &quot;Number of migrated nodes: &quot; + noOfMatches;
      
      storyboard.addPattern(srcGraphPO, false);
      
      &#x2F;&#x2F;==========================================================================
      noOfMatches = 0;
      
      srcGraphPO = new GraphPO(graph);
      
      EdgePO srcEdgePO = srcGraphPO.hasEdges();
      
      tgtGraphPO = new GraphPO(tgtGraphPO.getCurrentMatch()).withPattern(srcGraphPO.getPattern());
      
      tgtGraphPO.startCreate();
      
      EdgePO tgtEdgePO = tgtGraphPO.hasGcsEdge();
      
      boolean done = false;
      
      while (tgtEdgePO.getPattern().getHasMatch())
      {
         tgtEdgePO.withText(srcEdgePO.getName());
      
         copySrcNodePO = new EdgePO(srcEdgePO.getCurrentMatch())
         .hasSrc()
         .hasCopy();
         
         EdgePO copyEdgePO = new EdgePO(tgtEdgePO.getCurrentMatch()).withPattern(copySrcNodePO.getPattern());
         
         copySrcNodePO.startCreate();
         
         copyEdgePO.hasSrc(copySrcNodePO);
         

         copyTgtNodePO = new EdgePO(srcEdgePO.getCurrentMatch())
         .hasTgt()
         .hasCopy();
         
         EdgePO copyEdgePO2 = new EdgePO(tgtEdgePO.getCurrentMatch()).withPattern(copyTgtNodePO.getPattern());
         
         copyTgtNodePO.startCreate();
         
         copyEdgePO2.hasTgt(copyTgtNodePO);
         
         noOfMatches++;
         
         tgtEdgePO.getPattern().findNextMatch();
      }

      systemout += &quot;\nNumber of migrated Edges: &quot; + noOfMatches;
      
      storyboard.addPattern(tgtEdgePO, false);
      storyboard.addPattern(copySrcNodePO, false);
      storyboard.addPattern(copyTgtNodePO, false);
      
      return result;
   }</pre><embed type="image/svg+xml"src='TTC2011SimpleMigrationPatternDiagram16.svg'>
<embed type="image/svg+xml"src='TTC2011SimpleMigrationPatternDiagram17.svg'>
<embed type="image/svg+xml"src='TTC2011SimpleMigrationPatternDiagram18.svg'>
<embed type="image/svg+xml"src='TTC2011SimpleMigrationPatternDiagram19.svg'>
<embed type="image/svg+xml"src='TTC2011SimpleMigrationPatternDiagram20.svg'>
<p>Result graph: </p>
<embed type="image/svg+xml" src='TTC2011SimpleMigration23.svg'>
<p>Number of migrated nodes: 8
Number of migrated Edges: 10</p>
<hr/><h2>Migrate in Java: </h2><pre>   private void simpleMigrationInJava(Graph origGraph)
   {
      int noOfMatches = 0;
      
      if (origGraph != null)
      {
         Graph copyGraph = new Graph();
         
         &#x2F;&#x2F; migrate nodes
         for (Node origNode : origGraph.getNodes())
         {
            Node copyNode = (Node) copyGraph.createGcsNode()
                  .withText(origNode.getName());
            
            copyNode.withOrig(origNode);
            
            noOfMatches++;
         }

         systemout = &quot;Number of migrated nodes: &quot; + noOfMatches;
         
         &#x2F;&#x2F; migrate edges
         for (Edge origEdge : origGraph.getEdges())
         {
            Edge copyEdge = (Edge) copyGraph.createGcsEdge()
                  .withText(origEdge.getName());
            
            Node origSrcNode = origEdge.getSrc();
            
            if (origSrcNode != null)
            {
               copyEdge.setSrc(origSrcNode.getCopy());
            }

            Node origTgtNode = origEdge.getTgt();
            
            if (origTgtNode != null)
            {
               copyEdge.setTgt(origTgtNode.getCopy());
            }
         }
      }
      
   }</pre><p>Result graph: </p>
<embed type="image/svg+xml" src='TTC2011SimpleMigration29.svg'>
<p>Number of migrated nodes: 8</p>

</body>
</html>
