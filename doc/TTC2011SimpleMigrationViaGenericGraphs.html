<html>
<head><meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="style.css">
<link href="includes/diagramstyle.css" rel="stylesheet" type="text/css">

<script src="includes/dagre.js"></script>
<script src="includes/drawer.js"></script>
<script src="includes/graph.js"></script>
</head><body onload="init();">
<p>Storyboard <a href='../examples/org/sdmlib/examples/helloworld/HelloWorldTTC2011.java' type='text/x-java'>TTC2011SimpleMigrationViaGenericGraphs</a></p>
<p>TTC2011SimpleMigrationViaGenericGraphs</p>
<hr/><p>Source model:</p>
<embed type="image/svg+xml" src='TTC2011SimpleMigrationViaGenericGraphsClassDiagram3.svg'><hr/><p>Target model:</p>
<embed type="image/svg+xml" src='TTC2011SimpleMigrationViaGenericGraphsClassDiagram6.svg'><hr/><p>Create example source graph: </p>
<embed type="image/svg+xml" src='TTC2011SimpleMigrationViaGenericGraphs10.svg'>
<hr/><h2>Migrate using Generic Graph representation : </h2><pre>   private Graph simpleMigrationByGenericGraph(Graph origGraph, Storyboard storyboard)
   {
      GenericGraph genGraph = new Specific2Generic()
      .convert(GraphCreator.createIdMap(&quot;g1&quot;), origGraph);

      storyboard.addObjectDiagramWith(genGraph.getObjects(), genGraph.getLinks(), genGraph.getObjects().getAttrs());

      &#x2F;&#x2F; rename name to text attributes
      GenericGraphPO graphPO = new GenericGraphPO(genGraph);
      graphPO.hasObjects()
      .hasAttrs()
      .hasName(Node.PROPERTY_NAME)
      .startCreate()
      .hasName(Node.PROPERTY_TEXT)
      .allMatches();

      storyboard.addPattern(graphPO, false);

      &#x2F;&#x2F; storyboard.add(&quot;&lt;hr&#x2F;&gt;&quot;);

      &#x2F;&#x2F; rename graph--nodes links to parent--gcs links
      graphPO = new GenericGraphPO(genGraph);
      graphPO
      .hasLinks()
      .hasTgtLabel(Node.PROPERTY_GRAPH)
      .startCreate()
      .hasTgtLabel(Node.PROPERTY_PARENT)
      .hasSrcLabel(Graph.PROPERTY_GCS)
      .allMatches();

      storyboard.addPattern(graphPO, false);

      &#x2F;&#x2F; storyboard.add(&quot;&lt;hr&#x2F;&gt;&quot;);

      &#x2F;&#x2F; rename graph--edges links to parent--gcs links
      graphPO = new GenericGraphPO(genGraph);
      graphPO
      .hasLinks()
      .hasSrcLabel(Node.PROPERTY_GRAPH)
      .startCreate()
      .hasSrcLabel(Node.PROPERTY_PARENT)
      .hasTgtLabel(Graph.PROPERTY_GCS)
      .allMatches();

      storyboard.addPattern(graphPO, false);

      storyboard.addObjectDiagramWith(genGraph.getObjects(), genGraph.getLinks(), genGraph.getObjects().getAttrs());

      Graph tgtGraph = (Graph) new Generic2Specific().convert(GraphCreator.createIdMap(&quot;tg&quot;), null, genGraph);

      return tgtGraph;
   }</pre><embed type="image/svg+xml" src='TTC2011SimpleMigrationViaGenericGraphs14.svg'>
<embed type="image/svg+xml"src='TTC2011SimpleMigrationViaGenericGraphsPatternDiagram14.svg'>
<embed type="image/svg+xml"src='TTC2011SimpleMigrationViaGenericGraphsPatternDiagram15.svg'>
<embed type="image/svg+xml"src='TTC2011SimpleMigrationViaGenericGraphsPatternDiagram16.svg'>
<embed type="image/svg+xml" src='TTC2011SimpleMigrationViaGenericGraphs18.svg'>
<p>Result graph: </p>
<embed type="image/svg+xml" src='TTC2011SimpleMigrationViaGenericGraphs20.svg'>
<hr/><h2>Even more evolved graph model : </h2><embed type="image/svg+xml" src='TTC2011SimpleMigrationViaGenericGraphsClassDiagram22.svg'><pre>   private Graph simpleMigrationToEvenMoreEvolvedGraphByGenericGraph(Graph origGraph, Storyboard storyboard)
   {
      GenericGraph genGraph = new Specific2Generic()
      .convert(GraphCreator.createIdMap(&quot;g1&quot;), origGraph);

      &#x2F;&#x2F; rename name to text attributes
      GenericGraphPO graphPO = new GenericGraphPO(genGraph);
      graphPO
      .hasObjects()
      .hasAttrs()
      .hasName(Node.PROPERTY_NAME)
      .startCreate()
      .hasName(Node.PROPERTY_TEXT)
      .allMatches();

      storyboard.addPattern(graphPO, false);

      &#x2F;&#x2F; replace n.l.e.l.n by n.l.n
      GenericObjectPO edgePO = new GenericGraphPO(genGraph)
      .hasObjects()
      .hasType(Edge.class.getName());

      GenericLinkPO srcLinkPO = edgePO.hasOutgoingLinks().hasTgtLabel(Edge.PROPERTY_SRC);

      GenericLinkPO tgtLinkPO = edgePO.hasOutgoingLinks().hasTgtLabel(Edge.PROPERTY_TGT);

      GenericObjectPO srcNodePO = srcLinkPO.hasTgt();

      GenericObjectPO tgtNodePO = tgtLinkPO.hasTgt();

      edgePO.destroy(); 

      srcLinkPO.destroy();

      GenericLinkSet allMatches = tgtLinkPO.startCreate()
            .hasSrc(srcNodePO)
            .hasSrcLabel(Node.PROPERTY_LINKSFROM)
            .hasTgtLabel(Node.PROPERTY_LINKSTO)
            .allMatches();

      storyboard.addPattern(edgePO, false);

      &#x2F;&#x2F; destroy dangling edges
      GenericObjectPO danglingPO = new GenericGraphPO(genGraph)
      .hasObjects()
      .hasType(Edge.class.getName());

      danglingPO.destroy();

      danglingPO.allMatches();

      storyboard.addPattern(danglingPO, false);

      Graph tgtGraph = (Graph) new Generic2Specific().convert(GraphCreator.createIdMap(&quot;tg&quot;), null, genGraph);

      return tgtGraph;
   }</pre><embed type="image/svg+xml"src='TTC2011SimpleMigrationViaGenericGraphsPatternDiagram24.svg'>
<embed type="image/svg+xml"src='TTC2011SimpleMigrationViaGenericGraphsPatternDiagram25.svg'>
<embed type="image/svg+xml"src='TTC2011SimpleMigrationViaGenericGraphsPatternDiagram26.svg'>
<p>Result graph: </p>
<embed type="image/svg+xml" src='TTC2011SimpleMigrationViaGenericGraphs29.svg'>

</body>
</html>
