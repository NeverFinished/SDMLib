// MAJOR VERSION - Manually set
//----------------------
def majorVersion = 1
//----------------------

task printVersion {
    doFirst {
        println "$version"
    }
}

version = new Version(major: majorVersion, minor: getGitTag())
group = 'org.sdmlib'

class Version {
    int major, minor
    int revision = System.getenv().BUILD_NUMBER as int
    // change, if release is needed some day: boolean release
    // also change version above to accept release property
    boolean release = false

    String toString() {
        "$major.$minor.$revision${release ? '' : '-SNAPSHOT'}"
    }
}

def getGitTag() {
    def stdout = new ByteArrayOutputStream()
    exec {
        commandLine 'git', 'describe', '--abbrev=0', '--tags'
        standardOutput = stdout
    }
    stdout.toString().trim() as int
}